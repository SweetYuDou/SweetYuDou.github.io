<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>è¯»RE-Netåæœ‰ä½†ä¸å¤šçš„ä¸€äº›ç†è§£</title>
    <url>/2024/11/01/RE-Net/</url>
    <content><![CDATA[<h3 id="ã€ŠRecurrent-Event-Network-Autoregressive-Structure-Inference-over-Temporal-Knowledge-Graphsã€‹è®ºæ–‡è§£è¯»"><a href="#ã€ŠRecurrent-Event-Network-Autoregressive-Structure-Inference-over-Temporal-Knowledge-Graphsã€‹è®ºæ–‡è§£è¯»" class="headerlink" title="ã€ŠRecurrent Event Network: Autoregressive Structure Inference over Temporal Knowledge Graphsã€‹è®ºæ–‡è§£è¯»"></a>ã€ŠRecurrent Event Network: Autoregressive Structure Inference over Temporal Knowledge Graphsã€‹è®ºæ–‡è§£è¯»</h3><h4 id="RGCN"><a href="#RGCN" class="headerlink" title="RGCN"></a>RGCN</h4><p><img lazyload src="/images/loading.svg" data-src="https://www.helloimg.com/i/2024/11/15/67376238bf47b.png" alt="RGCN_formula"></p>
<p>W<sub>r</sub><sup>(l)</sup>æ˜¯æŸä¸€ä¸ªç‰¹å®šçš„å…³ç³»rï¼ˆå¦‚å¼¹åŠ¾ï¼Œä¸»åŠ¨å»ºäº¤ç­‰ï¼‰åœ¨ç¬¬lå±‚GCNä¸­çš„æƒé‡çŸ©é˜µï¼Œæ¯ä¸€ä¸ªä¸åŒçš„å…³ç³»rå¯¹åº”å…¶å¯¹åº”çš„æƒé‡çŸ©é˜µï¼Œæ¯”å¦‚r<sub>1</sub>å¯¹åº”W<sub>1</sub>è¿™æ ·</p>
<p>h<sub>o</sub><sup>(l)</sup>æ˜¯æŸä¸€ä¸ªç‰¹å®šçš„å®¢ä½“ï¼ˆobjectï¼‰åœ¨ç¬¬lå±‚GCNä¸­çš„éšè—è¡¨ç¤º&#x2F;ç‰¹å¾å‘é‡ï¼ˆhidden state&#x2F;embeddingï¼‰ï¼Œä¹Ÿå°±æ˜¯å½“å‰så®ä½“æ‰€æŒ‡å‘çš„é‚£ä¸ªoå®¢ä½“ï¼Œ<em><strong>h<sub>s</sub><sup>(l)</sup>åŒç†</strong></em></p>
<p>W<sub>o</sub><sup>(l)</sup>æ˜¯è‡ªç¯æƒé‡çŸ©é˜µï¼Œæ„æ€å°±æ˜¯å®ƒä¼šä¸èŠ‚ç‚¹sè‡ªèº«çš„ç‰¹å¾ä¸€ç›´ç›¸ä¹˜ç„¶åæ›´æ–°åˆ°ä¸‹ä¸€å±‚å†ç»§ç»­ç›¸ä¹˜</p>
<p>N<sub>t</sub><sup>(s,r)</sup>è¡¨ç¤ºåœ¨æ—¶é—´æˆ³tï¼ˆtimestampï¼‰è¿™ä¸ªæ—¶é—´ä¸‹çš„èŠ‚ç‚¹sé€šè¿‡å…³ç³»rçš„é‚»å±…èŠ‚ç‚¹é›†åˆï¼ˆNeighborhoodï¼‰ï¼Œ<em><strong>N<sub>t</sub><sup>(s)</sup>åŒç†</strong></em></p>
<p>c<sub>s</sub>æ˜¯å½’ä¸€åŒ–å¸¸æ•°ï¼Œä½“ç°åœ¨å…¬å¼é‡Œå°±æ˜¯ï¼šnum(o) * num(r)ï¼Œå°±æ˜¯å½“å‰tçš„å®ä½“så¯¹åº”çš„å®¢ä½“oçš„ä¸ªæ•°ä¹˜ä¸Šå½“å‰tè¿™ä¸ªså¯¹åº”çš„å…³ç³»rçš„ä¸ªæ•°ï¼ŒåŒ…å«äº†å¤šå°‘ä¸ªé‚»å±…çš„ä¿¡æ¯å°±å¹³å‡æ‰ã€‚<strong>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å½“å‰tçš„å®ä½“sçš„æ‰€æœ‰é‚»å±…ä¸ªæ•°</strong></p>
<p>RGCNèšåˆå™¨çš„ä½œç”¨åœ¨äºï¼šèšåˆèŠ‚ç‚¹sçš„é‚»å±…èŠ‚ç‚¹çš„ä¿¡æ¯ã€‚ç»“åˆå…¬å¼è§£è¯»ä¸€ä¸‹å°±æ˜¯ï¼šå¯¹äºèŠ‚ç‚¹sï¼ŒRGCNåœ¨æ›´æ–°èŠ‚ç‚¹ç‰¹å¾åŒæ—¶è€ƒè™‘<strong>èŠ‚ç‚¹è‡ªèº«çš„ç‰¹å¾</strong><img lazyload src="/images/loading.svg" data-src="https://www.helloimg.com/i/2024/11/15/67376238ab7d7.png" alt="self_loop">å’Œ<strong>å…¶é‚»å±…èŠ‚ç‚¹çš„ç‰¹å¾</strong><img lazyload src="/images/loading.svg" data-src="https://www.helloimg.com/i/2024/11/15/67376238b540f.png" alt="self_rel">ï¼Œä»¥åŠå®ƒä»¬ä¹‹é—´çš„å…³ç³»ç±»å‹ï¼ˆæŒ‡ä¸åŒå…³ç³»å¯¹åº”ä¸åŒæƒé‡çŸ©é˜µ)ã€‚</p>
<h4 id="RGCNæ¨¡å—ä»£ç å¦‚ä¸‹ï¼š"><a href="#RGCNæ¨¡å—ä»£ç å¦‚ä¸‹ï¼š" class="headerlink" title="RGCNæ¨¡å—ä»£ç å¦‚ä¸‹ï¼š"></a>RGCNæ¨¡å—ä»£ç å¦‚ä¸‹ï¼š</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">RGCNLayer</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, in_feat, out_feat, bias=<span class="literal">None</span>, activation=<span class="literal">None</span>, self_loop=<span class="literal">False</span>, dropout=<span class="number">0.0</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(RGCNLayer, <span class="variable language_">self</span>).__init__()</span><br><span class="line">        <span class="variable language_">self</span>.bias = bias</span><br><span class="line">        <span class="variable language_">self</span>.activation = activation</span><br><span class="line">        <span class="variable language_">self</span>.self_loop = self_loop</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.bias:</span><br><span class="line">            <span class="variable language_">self</span>.bias = nn.Parameter(torch.Tensor(out_feat))</span><br><span class="line">            nn.init.xavier_uniform_(<span class="variable language_">self</span>.bias,  gain=nn.init.calculate_gain(<span class="string">&#x27;relu&#x27;</span>))</span><br><span class="line">            <span class="comment"># xavier_uniform_ï¼šåˆå§‹åŒ–ï¼Œç”¨äºä¿è¯è¾“å…¥è¾“å‡ºçš„æ–¹å·®ç›¸åŒã€‚å¯ä»¥é¿å…éšç€å±‚æ•°çš„ä¼ é€’ï¼Œè¾“å…¥è¿‡å¤§è€Œæ¢¯åº¦æ¶ˆå¤±æˆ–è¾“å…¥è¿‡å°è€Œå¤±å»éçº¿æ€§</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># æƒé‡çŸ©é˜µ</span></span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.self_loop:</span><br><span class="line">            <span class="comment"># å›ç¯æƒé‡çŸ©é˜µ</span></span><br><span class="line">            <span class="comment"># input_feature,output_feature</span></span><br><span class="line">            <span class="variable language_">self</span>.loop_weight = nn.Parameter(torch.Tensor(in_feat, out_feat))</span><br><span class="line">            nn.init.xavier_uniform_(<span class="variable language_">self</span>.loop_weight, gain=nn.init.calculate_gain(<span class="string">&#x27;relu&#x27;</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> dropout:</span><br><span class="line">            <span class="variable language_">self</span>.dropout = nn.Dropout(dropout)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="variable language_">self</span>.dropout = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">propagate</span>(<span class="params">self, g, reverse</span>):</span><br><span class="line">        <span class="keyword">raise</span> NotImplementedError</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, g, reverse</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.self_loop:</span><br><span class="line">            <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            gæ˜¯graphï¼Œ.ndata[&#x27;h&#x27;]æ˜¯PyTorch DGLå›¾ï¼ˆGraphï¼‰å¯¹è±¡çš„ä¸€ä¸ªèŠ‚ç‚¹æ•°æ®å±æ€§ï¼Œå®ƒè¡¨ç¤ºå›¾ä¸­çš„èŠ‚ç‚¹ç‰¹å¾å‘é‡ã€‚</span></span><br><span class="line"><span class="string">            åœ¨ GNNs ä¸­ï¼ŒèŠ‚ç‚¹ç‰¹å¾å‘é‡é€šå¸¸ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šä¸€éƒ¨åˆ†æ˜¯é™æ€çš„ç‰¹å¾ï¼Œå¦‚èŠ‚ç‚¹ç±»åˆ«ã€å±æ€§ç­‰ï¼›</span></span><br><span class="line"><span class="string">            å¦ä¸€éƒ¨åˆ†æ˜¯åŠ¨æ€çš„ç‰¹å¾ï¼Œå¦‚ä¸èŠ‚ç‚¹ç›¸é‚»çš„èŠ‚ç‚¹æ•°é‡ã€èŠ‚ç‚¹ä¹‹é—´çš„è¾¹æƒé‡ç­‰ã€‚</span></span><br><span class="line"><span class="string">            &#x27;&#x27;&#x27;</span></span><br><span class="line">            loop_message = torch.mm(g.ndata[<span class="string">&#x27;h&#x27;</span>], <span class="variable language_">self</span>.loop_weight)</span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>.dropout <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                loop_message = <span class="variable language_">self</span>.dropout(loop_message)</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.propagate(g, reverse)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># åº”ç”¨biasåç§»å’Œæ¿€æ´»å‡½æ•°</span></span><br><span class="line">        node_repr = g.ndata[<span class="string">&#x27;h&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.bias:</span><br><span class="line">            node_repr = node_repr + <span class="variable language_">self</span>.bias</span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.self_loop:</span><br><span class="line">            node_repr = node_repr + loop_message</span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.activation:</span><br><span class="line">            node_repr = <span class="variable language_">self</span>.activation(node_repr)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ›´æ–°èŠ‚ç‚¹ç‰¹å¾å‘é‡</span></span><br><span class="line">        g.ndata[<span class="string">&#x27;h&#x27;</span>] = node_repr</span><br><span class="line">        <span class="keyword">return</span> g</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RGCNBlockLayer</span>(<span class="title class_ inherited__">RGCNLayer</span>):  <span class="comment"># RGCNå—å±‚</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, in_feat, out_feat, num_rels, num_bases, bias=<span class="literal">None</span>, activation=<span class="literal">None</span>, self_loop=<span class="literal">False</span>, dropout=<span class="number">0.0</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(RGCNBlockLayer, <span class="variable language_">self</span>).__init__(in_feat, </span><br><span class="line">                                             out_feat, </span><br><span class="line">                                             bias,</span><br><span class="line">                                             activation, </span><br><span class="line">                                             self_loop=self_loop,</span><br><span class="line">                                             dropout=dropout)</span><br><span class="line">        <span class="variable language_">self</span>.num_rels = num_rels</span><br><span class="line">        <span class="variable language_">self</span>.num_bases = num_bases</span><br><span class="line">        <span class="keyword">assert</span> <span class="variable language_">self</span>.num_bases &gt; <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.out_feat = out_feat</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.submat_in = in_feat // <span class="variable language_">self</span>.num_bases</span><br><span class="line">        <span class="variable language_">self</span>.submat_out = out_feat // <span class="variable language_">self</span>.num_bases</span><br><span class="line"></span><br><span class="line">        <span class="comment"># assuming in_feat and out_feat are both divisible by num_bases</span></span><br><span class="line">        <span class="comment"># if self.num_rels == 2:</span></span><br><span class="line">        <span class="comment">#     self.in_feat = in_feat</span></span><br><span class="line">        <span class="comment">#     self.weight = nn.Parameter(torch.Tensor(</span></span><br><span class="line">        <span class="comment">#         self.num_rels, in_feat, out_feat))</span></span><br><span class="line">        <span class="comment"># else:</span></span><br><span class="line">        <span class="variable language_">self</span>.weight = nn.Parameter(torch.Tensor(<span class="variable language_">self</span>.num_rels, <span class="variable language_">self</span>.num_bases * <span class="variable language_">self</span>.submat_in * <span class="variable language_">self</span>.submat_out))</span><br><span class="line">        nn.init.xavier_uniform_(<span class="variable language_">self</span>.weight, gain=nn.init.calculate_gain(<span class="string">&#x27;relu&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">msg_func</span>(<span class="params">self, edges, reverse</span>):  <span class="comment"># èŠ‚ç‚¹å’Œæƒé‡ç›¸ä¹˜ï¼Œå†è½¬åŒ–ä¸ºè¾“å‡ºæ ¼å¼</span></span><br><span class="line">        <span class="keyword">if</span> reverse:</span><br><span class="line">            <span class="comment"># edges.data[&#x27;type_o&#x27;]ï¼šè¡¨ç¤ºç›®æ ‡èŠ‚ç‚¹æ‰€å±çš„å…³ç³»çš„ç±»å‹ã€‚å…·ä½“å“ªä¸ªå…³ç³»å°±å¯¹åº”å®ƒçš„æƒé‡çŸ©é˜µ</span></span><br><span class="line">            weight = <span class="variable language_">self</span>.weight.index_select(<span class="number">0</span>, edges.data[<span class="string">&#x27;type_o&#x27;</span>]).view(-<span class="number">1</span>, <span class="variable language_">self</span>.submat_in, <span class="variable language_">self</span>.submat_out)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            weight = <span class="variable language_">self</span>.weight.index_select(<span class="number">0</span>, edges.data[<span class="string">&#x27;type_s&#x27;</span>]).view(-<span class="number">1</span>, <span class="variable language_">self</span>.submat_in, <span class="variable language_">self</span>.submat_out)</span><br><span class="line"></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        edges.src[&#x27;h&#x27;]ï¼šè¡¨ç¤ºæºèŠ‚ç‚¹çš„ç‰¹å¾å‘é‡ã€‚</span></span><br><span class="line"><span class="string">        å®ƒæ˜¯ä¸€ä¸ªå¤§å°ä¸º (num_nodes, submat_in) çš„tensorï¼Œå…¶ä¸­ num_nodes è¡¨ç¤ºå›¾ä¸­çš„èŠ‚ç‚¹æ•°ã€‚</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        node = edges.src[<span class="string">&#x27;h&#x27;</span>].view(-<span class="number">1</span>, <span class="number">1</span>, <span class="variable language_">self</span>.submat_in)</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        msgï¼šè¡¨ç¤ºæ¶ˆæ¯ä¼ é€’çš„ç»“æœã€‚</span></span><br><span class="line"><span class="string">        å®ƒæ˜¯ä¸€ä¸ªå¤§å°ä¸º (num_edges, out_feat) çš„tensorï¼Œå…¶ä¸­out_feat è¡¨ç¤ºè¾“å‡ºç‰¹å¾å‘é‡çš„ç»´åº¦ã€‚</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        msg = torch.bmm(node, weight).view(-<span class="number">1</span>, <span class="variable language_">self</span>.out_feat)</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&#x27;msg&#x27;</span>: msg&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">propagate</span>(<span class="params">self, g, reverse</span>):</span><br><span class="line">        g.update_all(<span class="keyword">lambda</span> x: <span class="variable language_">self</span>.msg_func(x, reverse), fn.<span class="built_in">sum</span>(msg=<span class="string">&#x27;msg&#x27;</span>, out=<span class="string">&#x27;h&#x27;</span>), <span class="variable language_">self</span>.apply_func)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">apply_func</span>(<span class="params">self, nodes</span>):</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&#x27;h&#x27;</span>: nodes.data[<span class="string">&#x27;h&#x27;</span>] * nodes.data[<span class="string">&#x27;norm&#x27;</span>]&#125;</span><br></pre></td></tr></table></figure></div>

<p>ç»“åˆä»£ç æ¥çœ‹å…¬å¼ï¼Œæ˜¯<img lazyload src="/images/loading.svg" data-src="/RE-Net/67376238ab7d7.png" alt="self_loop"></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">   		<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">         å…ˆè®©èŠ‚ç‚¹ç‰¹å¾å‘é‡ä¸è‡ªç¯æƒé‡çŸ©é˜µç›¸ä¹˜+dropout</span></span><br><span class="line"><span class="string">         &#x27;&#x27;&#x27;</span></span><br><span class="line">loop_message = torch.mm(g.ndata[<span class="string">&#x27;h&#x27;</span>], <span class="variable language_">self</span>.loop_weight)</span><br><span class="line">         <span class="keyword">if</span> <span class="variable language_">self</span>.dropout <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">             loop_message = <span class="variable language_">self</span>.dropout(loop_message)</span><br><span class="line">         <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">         å†æŠŠåç§»ã€ä¹˜ç§¯ã€æ¿€æ´»å‡½æ•°åŠ åœ¨åŸæœ‰çš„èŠ‚ç‚¹ç‰¹å¾å‘é‡ä¸Š</span></span><br><span class="line"><span class="string">         å…è®¸æ¯ä¸€å±‚éƒ½ä¿ç•™å‰ä¸€å±‚çš„ä¿¡æ¯ï¼Œæœ‰ç‚¹åƒResNetçš„æ€æƒ³</span></span><br><span class="line"><span class="string">         &#x27;&#x27;&#x27;</span></span><br><span class="line">	node_repr = g.ndata[<span class="string">&#x27;h&#x27;</span>]</span><br><span class="line">         <span class="keyword">if</span> <span class="variable language_">self</span>.bias:</span><br><span class="line">             node_repr = node_repr + <span class="variable language_">self</span>.bias</span><br><span class="line">         <span class="keyword">if</span> <span class="variable language_">self</span>.self_loop:</span><br><span class="line">             node_repr = node_repr + loop_message</span><br><span class="line">         <span class="keyword">if</span> <span class="variable language_">self</span>.activation:</span><br><span class="line">             node_repr = <span class="variable language_">self</span>.activation(node_repr)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">æŠŠæœ€åçš„èŠ‚ç‚¹è¡¨ç¤ºï¼ˆnode_reprï¼‰ä½œä¸ºè¯¥å±‚èŠ‚ç‚¹ç‰¹å¾å‘é‡çš„è¾“å‡º</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">         g.ndata[<span class="string">&#x27;h&#x27;</span>] = node_repr</span><br><span class="line">         <span class="keyword">return</span> g</span><br></pre></td></tr></table></figure></div>

<p><img lazyload src="/images/loading.svg" data-src="/RE-Net/67376238b540f.png" alt="self_rel">æ˜¯</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">  <span class="keyword">def</span> <span class="title function_">msg_func</span>(<span class="params">self, edges, reverse</span>): </span><br><span class="line">      <span class="keyword">if</span> reverse:</span><br><span class="line">          weight = <span class="variable language_">self</span>.weight.index_select(<span class="number">0</span>, edges.data[<span class="string">&#x27;type_o&#x27;</span>]).view(-<span class="number">1</span>, <span class="variable language_">self</span>.submat_in, <span class="variable language_">self</span>.submat_out)</span><br><span class="line">      <span class="keyword">else</span>:</span><br><span class="line">          weight = <span class="variable language_">self</span>.weight.index_select(<span class="number">0</span>, edges.data[<span class="string">&#x27;type_s&#x27;</span>]).view(-<span class="number">1</span>, <span class="variable language_">self</span>.submat_in, <span class="variable language_">self</span>.submat_out)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">å…ˆæ‰¾åˆ°ç›®æ ‡èŠ‚ç‚¹æ‰€å±çš„å…³ç³»çš„ç±»å‹ï¼ˆæ¯”å¦‚ï¼šå¼¹åŠ¾ã€è¢«å¼¹åŠ¾ï¼›é€‰ä¸¾ã€è¢«é€‰ä¸¾ï¼‰</span></span><br><span class="line"><span class="string">æ‹¿åˆ°è¯¥å…³ç³»æ‰€å¯¹åº”çš„æƒé‡çŸ©é˜µ</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">      node = edges.src[<span class="string">&#x27;h&#x27;</span>].view(-<span class="number">1</span>, <span class="number">1</span>, <span class="variable language_">self</span>.submat_in)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">å°†æºèŠ‚ç‚¹çš„ç‰¹å¾å‘é‡ä¸æƒé‡ç›¸ä¹˜</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">      msg = torch.bmm(node, weight).view(-<span class="number">1</span>, <span class="variable language_">self</span>.out_feat)</span><br><span class="line">      <span class="keyword">return</span> &#123;<span class="string">&#x27;msg&#x27;</span>: msg&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">propagate</span>(<span class="params">self, g, reverse</span>):</span><br><span class="line">      g.update_all(<span class="keyword">lambda</span> x: <span class="variable language_">self</span>.msg_func(x, reverse), fn.<span class="built_in">sum</span>(msg=<span class="string">&#x27;msg&#x27;</span>, out=<span class="string">&#x27;h&#x27;</span>), <span class="variable language_">self</span>.apply_func)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">æŠŠè¯¥æºèŠ‚ç‚¹çš„æ‰€æœ‰é‚»å±…èŠ‚ç‚¹çš„msgç»“æœç›¸åŠ èšåˆ</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">apply_func</span>(<span class="params">self, nodes</span>):</span><br><span class="line">      <span class="keyword">return</span> &#123;<span class="string">&#x27;h&#x27;</span>: nodes.data[<span class="string">&#x27;h&#x27;</span>] * nodes.data[<span class="string">&#x27;norm&#x27;</span>]&#125;</span><br><span class="line">  	<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">  	æœ€åä¹˜ä¸Šå½’ä¸€åŒ–å¸¸æ•°nodes.data[&#x27;norm&#x27;]</span></span><br><span class="line"><span class="string">  	&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p>RGCNæ•æ‰å¤šè·³é‚»å±…çš„ä¿¡æ¯ï¼šé€šè¿‡å¤šæ¬¡åº”ç”¨å›¾å·ç§¯æ“ä½œå®ç°</p>
<ul>
<li>åœ¨ç¬¬ä¸€æ¬¡è¿­ä»£ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹èšåˆæ¥è‡ªå…¶ç›´æ¥é‚»å±…çš„ä¿¡æ¯</li>
<li>åœ¨ç¬¬äºŒæ¬¡è¿­ä»£ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹åˆæ¥è‡ªå…¶é‚»å±…çš„é‚»å±…ï¼ˆå³ç¬¬äºŒè·³é‚»å±…ï¼‰çš„ä¿¡æ¯</li>
</ul>
<h4 id="RE-Netæ¶æ„å›¾è§£è¯»"><a href="#RE-Netæ¶æ„å›¾è§£è¯»" class="headerlink" title="RE-Netæ¶æ„å›¾è§£è¯»"></a>RE-Netæ¶æ„å›¾è§£è¯»</h4><p><img lazyload src="/images/loading.svg" data-src="https://www.helloimg.com/i/2024/11/15/67376238ebfd3.png" alt="RE-Net_architecture"></p>
<p>ä»»åŠ¡ï¼šé¢„æµ‹æ—¶é—´æˆ³tä¸­çš„ä¸‰å…ƒç»„</p>
<p>å·²çŸ¥ï¼šè¿‡å»å‡ ä¸ªæ—¶é—´æ­¥çš„å›¾ï¼ˆæ¶æ„å›¾ä¸¾ä¾‹ä¸º3ä¸ªæ—¶é—´æ­¥ï¼‰</p>
<p>RE-Net_globalå¯¹æ•´ä¸ªçŸ¥è¯†å›¾è°±ï¼ˆèƒ½è§‚å¯Ÿåˆ°çš„å›¾ï¼Œæ¶æ„å›¾ä¸­æ•´ä¸ªå›¾è°±ä¸º3ä¸ªæ—¶é—´æ­¥çš„å›¾ï¼‰è¿›è¡Œç¼–ç ï¼Œç»™å‡ºå…¨å±€åµŒå…¥è¡¨ç¤ºï¼ˆglobal_embï¼‰ã€‚åœ¨é¢„æµ‹æ—¶ç»™å‡ºé¢„æµ‹æ—¶é—´æˆ³tçš„ä¸»ä½“ã€å®¢ä½“åˆ†å¸ƒä»¥åŠæ›´æ–°åçš„å…¨å±€åµŒå…¥è¡¨ç¤º</p>
<p>RE-Net(train)ï¼šå°†å¯è§‚å¯Ÿåˆ°çš„å±€éƒ¨å›¾ä¸­çš„s,rå’Œglobal_embç­‰æ”¾å…¥Aggregatorèšåˆå™¨ï¼ˆRGCNï¼‰å½“ä¸­ï¼Œèšåˆå™¨çš„è¾“å‡ºç»“æœä¸ºä¸¤ä¸ªåºåˆ—s_packed_input,s_packed_input_råˆ†åˆ«æ”¾å…¥encoder,encoder_rä¸­ï¼Œç¼–ç å®ä½“è¡¨ç¤ºå’Œå…³ç³»è¡¨ç¤ºï¼ŒRE-Netç±»çš„self.encoderè¢«å®šä¹‰ä¸ºnn.GRUï¼Œæœ€ååˆ†åˆ«é€å…¥çº¿æ€§å±‚self.linear,self.linear_r(nn.linear)å’Œdropoutå±‚é¢„æµ‹å®¢ä½“å’Œå…³ç³»å¹¶åˆ†åˆ«è®¡ç®—æŸå¤±</p>
<p>RE-Net(valid,test)ï¼šRE-Net_globalé¢„æµ‹æ—¶é—´æˆ³tçš„ä¸»ä½“ï¼Œå®¢ä½“åˆ†å¸ƒåé‡‡æ ·å‰self.num_kä¸ªï¼Œæ›´æ–°ï¼ˆä¸»ä½“å’Œå®¢ä½“çš„åˆ—è¡¨ã€ç´¢å¼•ã€å†å²äº¤äº’ç¼“å­˜ï¼‰ï¼Œæ„å»ºæ–°çš„æ—¶é—´ç‚¹çš„å›¾ï¼Œæ›´æ–°å›¾å­—å…¸ï¼ˆgraph_dictï¼‰å’Œå…¨å±€åµŒå…¥è¡¨ç¤ºï¼ˆglobal_embï¼‰ã€‚å†é‡å¤ä»¥ä¸Šæ“ä½œâ†‘</p>
]]></content>
      <categories>
        <category>deep-learning</category>
      </categories>
      <tags>
        <tag>çŸ¥è¯†å›¾è°±</tag>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>ç©Dockeråæœ‰ä½†ä¸å¤šçš„ä¸€äº›å¿ƒå¾—</title>
    <url>/2024/11/14/Docker/</url>
    <content><![CDATA[<ul>
<li>dockeré•œåƒæºï¼ˆåŠ é€Ÿåœ°å€ï¼‰æ˜¯å›½å†…çš„æºæ¥æ‹‰é•œåƒï¼Œå¯èƒ½æœ‰ä¸€äº›é•œåƒæ²¡æœ‰ï¼Œä»£ç†å°±æ˜¯ä»Docker hubæ‹‰ã€‚<strong>ä½ æ‹‰çš„é•œåƒå¦‚æœæ˜¯<em>Dockerhub</em>çš„ï¼Œå¹¶ä¸”å›½å†…é•œåƒæºæ²¡æœ‰ï¼Œé‚£é•œåƒæºä¹Ÿä¸å¥½ä½¿ï¼Œåªèƒ½è€è€å®å®é…åˆä»£ç†</strong>ã€‚é˜¿é‡Œäº‘ECSå¯ä»¥ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿå™¨ï¼Œ<code>/etc/docker/daemon.json</code>å¦‚ä¸‹é…ç½®å³å¯ï¼Œä¸è¦åŠ å…¶ä»–æºï¼š</li>
</ul>
<div class="highlight-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;registry-mirrors&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;https://***.mirror.aliyuncs.com&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div>

<ul>
<li>æœ¬åœ°è®¿é—®é˜¿é‡Œäº‘ECSçš„ç½‘é¡µæ—¶ï¼Œè‹¥å‡ºç°æ— æ³•è®¿é—®çš„é—®é¢˜ï¼Œå¯ä»¥æ£€æŸ¥è¯¥ECSé…ç½®çš„å®‰å…¨ç»„æ˜¯å¦å¼€æ”¾HTTPï¼ˆ80ï¼‰ã€HTTPSï¼ˆ443ï¼‰ç«¯å£ã€‚</li>
<li>ç”¨clashæ¥ç»™æœåŠ¡å™¨<strong>é…ç½®ä»£ç†</strong>ï¼Œå¯ä»¥å‚è€ƒ<a class="link" href="https://github.com/nelvko/clash-for-linux-install?tab=readme-ov-file">nelvko&#x2F;clash-for-linux-install: ä¼˜é›…åœ°éƒ¨ç½²åŸºäº Clash çš„ä»£ç†ç¯å¢ƒ <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>ï¼Œå…¶ä¸­è®¢é˜…å°±æ˜¯ä¸€ä¸ªé“¾æ¥ï¼Œå¯ä»¥ä»æœºåœºç½‘ç«™ä¸Šæ‰¾ï¼Œç±»ä¼¼è¿™æ ·çš„ï¼š</li>
</ul>
<p><img lazyload src="/images/loading.svg" data-src="https://www.helloimg.com/i/2024/11/15/673762390d8ea.png" alt="subscription"></p>
<p>æˆ‘è¿™é‡Œç”¨çš„æ˜¯clashï¼Œå°±å¤åˆ¶clashè®¢é˜…é“¾æ¥å°±å¥½äº†ã€‚éƒ¨ç½²å®Œclashåï¼ŒæœåŠ¡å™¨å¼€æ”¾ç«¯å£7890ä½œä¸ºä»£ç†æ¥å£ï¼Œæ¥è®¿é—®ä»£ç†æœåŠ¡å™¨ã€‚åœ¨æœåŠ¡å™¨ç»ˆç«¯è®¾ç½®ç›¸å…³ç¯å¢ƒå˜é‡ï¼š</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> https_proxy=http://127.0.0.1:7890 http_proxy=http://127.0.0.1:7890 </span><br></pre></td></tr></table></figure></div>

<p>ç”±äºé…ç½®ä»£ç†æ˜¯ä¸ºäº†dockeræœåŠ¡ï¼Œæ‰€ä»¥è¿˜è¦ç¼–è¾‘Dockerç³»ç»Ÿçš„æœåŠ¡é…ç½®æ–‡ä»¶ï¼š</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">mkdir</span> -p /etc/systemd/system/docker.service.d</span><br><span class="line"><span class="built_in">sudo</span> vim /etc/systemd/system/docker.service.d/proxy.conf</span><br></pre></td></tr></table></figure></div>

<p>åœ¨proxy.confä¸­é…ç½®ä»¥ä¸‹å†…å®¹ï¼š</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">[Service]</span><br><span class="line">Environment=<span class="string">&quot;HTTP_PROXY=http://127.0.0.1:7890&quot;</span></span><br><span class="line">Environment=<span class="string">&quot;HTTPS_PROXY=http://127.0.0.1:7890&quot;</span></span><br></pre></td></tr></table></figure></div>

<p>æœ€åé‡å¯dockerï¼š</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl daemon-reload</span><br><span class="line"><span class="built_in">sudo</span> systemctl restart docker</span><br></pre></td></tr></table></figure></div>

<p>ä¸å‡ºæ„å¤–åº”è¯¥æˆåŠŸäº†ï¼Œå¯ä»¥å°è¯•æ‹‰å–ä¸€äº›ä¹‹å‰æ‹‰å–å¤±è´¥çš„é•œåƒæ¥éªŒè¯ä¸€ä¸‹</p>
<p><img lazyload src="/images/loading.svg" data-src="https://www.helloimg.com/i/2024/11/20/673d70d56e2f1.png" alt="traffic"></p>
<ul>
<li>é˜¿é‡Œäº‘äº‘æ•°æ®ä¼ è¾“çš„æµé‡<strong>æŒ‰é‡è®¡ç®—ï¼Œä¸¤å¤©å°±èŠ±äº†151.05CNYâ€¦TuT</strong>ï¼Œç›®å½•ä»·å› å­éƒ½æ˜¯æµå‡ºåœ°åŸŸï¼Œæˆ‘ç”¨Xftp7æŠŠECSä¸Šçš„æ–‡ä»¶ä¼ åˆ°æœ¬åœ°ä¹Ÿç”¨ä¸åˆ°100å¤šä¸ªGå§ï¼Ÿæš‚æ—¶è¿˜æ²¡æƒ³åˆ°æ˜¯ä¸ºä»€ä¹ˆï¼Œåªå¥½å…ˆæš‚åœæœåŠ¡äº†</li>
</ul>
]]></content>
      <categories>
        <category>chit-chat</category>
      </categories>
      <tags>
        <tag>Docker</tag>
        <tag>é˜¿é‡Œäº‘ECS</tag>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>ç©Spring Bootåæœ‰ä½†ä¸å¤šçš„ä¸€äº›å¿ƒå¾—</title>
    <url>/2024/11/16/Maven/</url>
    <content><![CDATA[<ul>
<li>Mavenè¿œç¨‹ä»“åº“é»˜è®¤ä¸ºMaven Central Repositoryï¼Œå¯ä»¥åœ¨<code>/conf/settings.xml</code>ä¸­é…ç½®è¿œç¨‹é•œåƒä»“åº“ä¸ºå›½å†…é˜¿é‡Œäº‘é•œåƒä»“åº“ï¼Œæé«˜JaråŒ…ä¸‹è½½çš„é€Ÿåº¦å’Œç¨³å®šæ€§ã€‚é…ç½®settings.xmlå®Œæˆåä¿å­˜é€€å‡ºã€‚</li>
</ul>
<div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="code"><pre><span class="line"># åœ¨settings.xml 160è¡Œå¤„æ·»åŠ é•œåƒæºï¼Œéœ€è¦ä¿è¯é•œåƒæºæ ‡ç­¾åœ¨mirrorçš„ç¬¬ä¸€ä¸ª</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">id</span>&gt;</span>alimaven<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun maven<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://maven.aliyun.com/repository/public<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p><img lazyload src="/images/loading.svg" data-src="https://www.helloimg.com/i/2024/11/16/67377c04abc81.png" alt="image-20241116005159364">åƒè¿™æ ·ï¼Œé•œåƒæºå¾—åœ¨å‰ï¼Œå¦åˆ™ä¼šæŠ¥é”™</p>
<ul>
<li>IntelliJ IDEAä¸­é¡¹ç›®ä»£ç è‹¥å‡ºç°æ— æ³•è§£æç¬¦å·â€œxxxâ€æŠ¥é”™ä¸”é¼ æ ‡æŒ‡é’ˆç§»åˆ°æŠ¥é”™çš„ç¬¦å·ï¼ˆè¢«é«˜äº®ä¸ºçº¢è‰²ï¼‰ä¸Šæ²¡æœ‰æç¤ºâ€å¯¼å…¥ç±»â€™xxxâ€˜æ—¶â€œï¼Œå¯ä»¥å°è¯•ç‚¹å‡»å³ä¾§â€æ›´å¤šæ“ä½œâ€œ</li>
</ul>
<p><img lazyload src="/images/loading.svg" data-src="https://www.helloimg.com/i/2024/11/25/6743503f889cd.png" alt="æ›´å¤šæ“ä½œ"></p>
<p>ç‚¹å‡»â€œæ·»åŠ Mavenä¾èµ–é¡¹â€</p>
<p><img lazyload src="/images/loading.svg" data-src="https://www.helloimg.com/i/2024/11/25/6743503f852b2.png" alt="æ·»åŠ Mavenä¾èµ–é¡¹"></p>
<p>å†é€‰æ‹©åˆé€‚çš„ç‰ˆæœ¬</p>
<p><img lazyload src="/images/loading.svg" data-src="https://www.helloimg.com/i/2024/11/25/6743503f5ecf4.png" alt="é€‰æ‹©åˆé€‚ç‰ˆæœ¬"></p>
<p>æœ€åå†å¯¼å…¥ç±»ï¼Œå³å¯è§£å†³æŠ¥é”™</p>
]]></content>
      <categories>
        <category>chit-chat</category>
      </categories>
      <tags>
        <tag>é˜¿é‡Œäº‘ECS</tag>
        <tag>Maven</tag>
        <tag>å­¦ä¹ ç¬”è®°</tag>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title>ABOUTME</title>
    <url>/2024/09/17/ABOUTME/</url>
    <content><![CDATA[<p>æˆ‘ç°åœ¨æ˜¯ä¸€åå¤§ä¸‰å­¦ç”Ÿï¼Œå°±è¯»äºç”µå­ç§‘æŠ€å¤§å­¦ä¿¡æ¯ä¸è½¯ä»¶å·¥ç¨‹å­¦é™¢ï¼ˆ2022-2026ï¼‰ã€‚ç›®å‰åœ¨å­¦ä¹ è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰ã€å¤šæ¨¡æ€å­¦ä¹ ç­‰æ·±åº¦å­¦ä¹ é¢†åŸŸçš„çŸ¥è¯†ã€‚æœªæ¥æˆ‘ä¼šå°†æˆ‘çš„ä¸€äº›å­¦ä¹ ç¬”è®°ã€æ—¥å¸¸åˆ†äº«ç­‰å‘è¡¨åˆ°ä¸ªäººåšå®¢ä¸Šï¼Œæƒä¸”å½“ä½œè®°å½•ç”Ÿæ´»å¥½äº†ï¼Œå¸Œæœ›èƒ½å¤Ÿç»™äºˆä½ æŠ€æœ¯æˆ–ç”Ÿæ´»ç­‰æ–¹é¢çš„ä¸€äº›å¸®åŠ©ï¼Œä¹Ÿå¸Œæœ›å„ä½å¤§ä½¬èƒ½å¤Ÿç»™äºˆæˆ‘å®è´µçš„å»ºè®®ğŸ™ğŸ™ğŸ™æ„¿ä½ æˆ‘å…±åŒè¿›æ­¥ï¼Œæˆä¸ºæ›´å¥½çš„è‡ªå·±</p>
<p>I am currently a junior student majoring in the School of Information and Software Engineering at the University of Electronic Science and Technology of China (from 2022 to 2026). At present, I am learning knowledge in the fields of deep learning such as natural language processing(NLP) and multimodal Deep Learning. In the future, I will post some of my study notes, daily sharings, etc. on my personal blog. Just consider it as recording my life. I hope it can offer you some help in terms of technology or life. Also, I sincerely hope that all the big shots can give me their valuable suggestionsğŸ™ğŸ™ğŸ™ May we progress together and become better versions of ourselves.</p>
<p><img lazyload src="/images/loading.svg" data-src="https://www.helloimg.com/i/2024/11/25/67435978def63.jpg" alt="SBç”µå­ç§‘æŠ€å¤§å­¦"></p>
]]></content>
      <categories>
        <category>chit-chat</category>
      </categories>
      <tags>
        <tag>me</tag>
      </tags>
  </entry>
</search>
